<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>PHPのHello,WorldとAjaxのHello,Worldを比較してみる</title>
    </head>
<body>

<h4>XMLHttpRequestオブジェクトを生成する</h4>

<p>非同期通信を管理するのは、XMLHttpRequestオブジェクトの役割です。<br>
    XMLHttpRequestオブジェクトを利用することで、<br>
    これまでブラウザに任せてきたサーバーとの通信部分を、<br>
    JavaScriptで制御できるようになります。<br>
    <br>
    XMLHttpRequestオブジェクトを利用できる主なメンバーはこんなイメージです。
    <br>
    プロパティ型（応答にまつわるもの）
    <br>
    メソッド型（通信を取得するもの）
    <br>
    </p>
    
    <h4>
        サーバー通信時の処理を定義する
    </h4>
    
    <p>
        XMLHttpRequestオブジェクトが生成できたら、<br>
        onreadystatechangeプロパティで通信開始から終了まで実行すべき処理を定義します。<br>
        
        onreadystatechangeは、通信の状態が変化したタイミングで呼び出されるイベントハンドラーです。<br>
        on ready state change（翻訳：準備中の変更時）
    </p>
    
    <p>
    ・サーバーから正常な応答を受け取ったタイミングで、ページの更新処理を行う<br>
    ・サーバーからエラーが返された場合に、エラーメッセージを表示する<br>
    ・サーバーへの通信を開始したタイミングで、「通信中...」メッセージを表示する<br>
    </p>

    <p>onreadystatechangeイベントハンドラの一般的な処理の流れは、以下の通りです。</p>
    
<h4>サーバー通信時の処理を定義する</h4>    
<h4>コールバック関数</h4>

    <p>
    通信の状態が変化した。
    <br>↓<br>
    非同期通信が完了したか → No(readyStatus !== 4) → [通信中...]メッセージを表示
    <br>↓<br>
    <br>Yes<br>
    <br>↓<br>
    サーバーからの応答 → エラー（status !== 200）→エラーメッセージ表示
    <br>↓<br>
    正常（status === 200）
    <br>↓<br>
    サーバー空の応答メッセージに反映
</p>

<h4>進捗メッセージを示すのは開発者の責任</h4>

<p>同期通信（Ajax技術を用いない通常の通信）では、<br>
    ブラウザはそのアイコンやプログレスバーなどによって通信の状態をを示します。<br>
</p>

<h4>サーバー通信時の処理を定義する</h4>
<p> XMLHttpRequestオブジェクトでは、以下のイベントが用意されており、<br>
    これらを利用して通信時の処理を定義することもできます。<br>
</p>

<p>
    これらのイベントを利用することで、<br>
    readyState/statusプロパティによる判定が不要になるので、<br>
    よりコードをが書きやすくなります。
<p>
    

<!--   
    <script src="JS/7-4.1-2.js"></script>
-->
</body>
</html>
